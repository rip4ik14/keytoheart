// ✅ Путь: components/PolicyPageClient.tsx
'use client';

import Link from 'next/link';
import { motion } from 'framer-motion';
import PolicyLink from '@components/PolicyLink';
import ContactLink from '@components/ContactLink';
import { trackEvent } from '@/lib/analytics';

export default function PolicyPageClient() {
  const handleLinkClick = (label: string, type: 'email' | 'phone' | 'policy') => {
    trackEvent({
      category: 'Navigation',
      action: 'policy_page_link_click',
      label,
      type,
    });
  };

  const sectionVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0, transition: { duration: 0.5 } },
  };

  return (
    <section className="container mx-auto px-4 py-10 max-w-4xl text-base leading-relaxed text-black space-y-6">
      <motion.h1
        className="text-2xl sm:text-3xl font-sans font-bold text-center"
        role="heading"
        aria-level={1}
        variants={sectionVariants}
        initial="hidden"
        whileInView="visible"
        viewport={{ once: true }}
      >
        Политика конфиденциальности персональных данных
      </motion.h1>

      <motion.p
        variants={sectionVariants}
        initial="hidden"
        whileInView="visible"
        viewport={{ once: true }}
      >
        Настоящая Политика конфиденциальности персональных данных (далее – Политика) разработана в соответствии с Федеральным законом от 27.07.2006 № 152-ФЗ «О персональных данных» и иными действующими законами РФ, действует в отношении всей информации, которую интернет-магазин KEY TO HEART, расположенный на доменном имени{' '}
        <Link
          href="/"
          className="underline hover:text-gray-500 transition-colors duration-300"
          aria-label="Перейти на главную страницу KEY TO HEART"
          onClick={() => handleLinkClick('Главная страница', 'policy')}
        >
          keytoheart.ru
        </Link>{' '}
        (и его субдоменах), может получить о Пользователе во время использования сайта, его программ и продуктов.
      </motion.p>

      {/* 1. Определения */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">1. Определение терминов</h2>
        <ol className="list-decimal pl-5 space-y-1" role="list">
          <li><strong>Администрация сайта</strong> – Уполномоченные сотрудники, действующие от имени ИП Рашевская Регина Сергеевна (ИНН 234810526700, ОГРНИП 324237500032680), которые организуют и осуществляют обработку персональных данных, определяют цели обработки, состав данных и операции с ними.</li>
          <li><strong>Персональные данные</strong> – Любая информация, относящаяся к прямо или косвенно определяемому физическому лицу (субъекту персональных данных).</li>
          <li><strong>Обработка персональных данных</strong> – Любое действие или совокупность действий с использованием средств автоматизации или без таковых: сбор, запись, систематизация, накопление, хранение, уточнение, извлечение, использование, передача, обезличивание, блокирование, удаление, уничтожение.</li>
          <li><strong>Конфиденциальность персональных данных</strong> – Обязательное требование не допускать распространения данных без согласия субъекта или иного законного основания.</li>
          <li><strong>Cookies</strong> – Небольшой фрагмент данных, отправляемый сервером и хранимый на устройстве Пользователя.</li>
          <li><strong>IP-адрес</strong> – Уникальный сетевой адрес узла в компьютерной сети.</li>
          <li><strong>Сайт KEY TO HEART</strong> – Совокупность веб-страниц под доменом keytoheart.ru и его субдоменами.</li>
          <li><strong>Пользователь</strong> – Лицо, использующее сайт KEY TO HEART через Интернет.</li>
        </ol>
      </motion.section>

      {/* 2. Общие положения */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">2. Общие положения</h2>
        <ol className="list-decimal pl-5 space-y-1" role="list">
          <li>Использование сайта означает согласие Пользователя с условиями этой Политики. Минимальная обработка данных (например, для оформления заказа) возможна без согласия на маркетинговые цели.</li>
          <li>При несогласии с условиями Пользователь должен прекратить использование сайта.</li>
          <li>Политика применяется ко всем субдоменам keytoheart.ru. Администрация не контролирует сторонние ресурсы по внешним ссылкам.</li>
          <li>Администрация не проверяет достоверность предоставленных Пользователем данных, но принимает меры для их защиты.</li>
          <li>Все данные хранятся на серверах в Российской Федерации в соответствии с требованиями законодательства РФ. Трансграничная передача персональных данных не осуществляется.</li>
          <li>Актуальная версия настоящей Политики всегда размещена на сайте keytoheart.ru.</li>
        </ol>
      </motion.section>

      {/* 3. Правовые основания обработки */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">3. Правовые основания обработки</h2>
        <ul className="list-disc pl-5 space-y-1">
          <li>Ст. 6 ФЗ № 152-ФЗ — исполнение договора купли-продажи (оформление и доставка заказа);</li>
          <li>Ст. 10.1 ФЗ № 149-ФЗ — обработка файлов cookies и идентификаторов устройств для функционирования сайта;</li>
          <li>Ст. 15 ФЗ № 38-ФЗ — рассылка рекламы и информации только с согласия пользователя;</li>
          <li>Ст. 54-ФЗ — оформление чеков, ведение бухгалтерии;</li>
          <li>Передача данных госорганам РФ — по закону и по официальному запросу.</li>
        </ul>
      </motion.section>

      {/* 4. Перечень и состав данных */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">4. Состав обрабатываемых персональных данных</h2>
        <ul className="list-disc pl-5 space-y-1" role="list">
          <li>Фамилия, имя, отчество Пользователя;</li>
          <li>Контактный телефон;</li>
          <li>Адрес электронной почты (e-mail);</li>
          <li>Адрес доставки товара;</li>
          <li>Данные о местоположении (при необходимости для доставки);</li>
          <li>Комментарии к заказу (при необходимости);</li>
          <li>IP-адрес, данные cookies, информация о браузере, лог-файлы, уникальные идентификаторы устройства, сведения о действиях на сайте;</li>
          <li>Фотографии, отзывы, любые другие данные, добровольно предоставленные Пользователем через сайт, формы или e-mail.</li>
        </ul>
        <p>
          Согласие на обработку персональных данных предоставляется Пользователем свободно, осознанно и однозначно — путём установки галочки в форме, оформления заказа, регистрации на сайте, либо через баннер cookies. Факт получения согласия фиксируется логами сервера и записями в базе данных.
        </p>
      </motion.section>

      {/* 5. Цели обработки */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">5. Цели обработки персональных данных</h2>
        <ul className="list-disc pl-5 space-y-1" role="list">
          <li>Идентификация Пользователя для выполнения заказа, обратной связи, авторизации и других действий;</li>
          <li>Оформление, доставка и оплата заказов, возврат и обмен товаров;</li>
          <li>Установление обратной связи, отправка уведомлений, информирование о статусе заказа, бонусах, изменениях в работе сайта;</li>
          <li>Предоставление персонализированного сервиса, участие в программе лояльности, начисление бонусов;</li>
          <li>Проведение маркетинговых и рекламных рассылок — только с согласия Пользователя;</li>
          <li>Аналитика и улучшение качества работы сайта, персонализация сервисов;</li>
          <li>Обеспечение безопасности, предотвращение мошенничества, ведение статистики, расследование инцидентов;</li>
          <li>Выполнение требований законодательства РФ (включая хранение бухгалтерских документов, отчётность, ответы на запросы госорганов);</li>
          <li>Обезличивание данных для передачи по запросу государственных органов, в рамках отчётности, анализа и статистики.</li>
        </ul>
      </motion.section>

      {/* 6. Способы и сроки обработки */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">6. Способы и сроки обработки данных</h2>
        <ol className="list-decimal pl-5 space-y-1" role="list">
          <li>Обработка осуществляется автоматизированными и/или неавтоматизированными способами, включая сбор, хранение, систематизацию, обезличивание, удаление.</li>
          <li>Срок хранения данных — до достижения целей обработки, либо по запросу Пользователя об удалении, кроме случаев, установленных законом (например, бухгалтерские документы — не менее 5 лет согласно 402-ФЗ).</li>
          <li>При отзыве согласия Пользователя на обработку данных дальнейшее хранение допускается только по требованиям закона.</li>
          <li>Трансграничная передача персональных данных не осуществляется. Все данные хранятся и обрабатываются только на территории РФ.</li>
        </ol>
      </motion.section>

      {/* 7. Передача третьим лицам */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">7. Передача персональных данных третьим лицам</h2>
        <ul className="list-disc pl-5 space-y-1" role="list">
          <li>Передача данных допускается только для исполнения заказа — курьерским службам, платёжным системам, IT-подрядчикам, сервисам рассылок, техническим специалистам. Все третьи лица обязаны соблюдать конфиденциальность на основании договора/NDA.</li>
          <li>Передача данных государственным органам РФ осуществляется только на основании и в порядке, установленном действующим законодательством.</li>
          <li>Передача данных по инициативе пользователя (например, при публикации отзыва или фотографии) осуществляется исключительно по его согласию.</li>
        </ul>
      </motion.section>

      {/* 8. Защита персональных данных */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">8. Защита персональных данных</h2>
        <ul className="list-disc pl-5 space-y-1" role="list">
          <li>Используются организационные и технические меры: шифрование, ограничение доступа, резервное копирование, HTTPS, контроль доступа, журналирование операций с данными, обучение сотрудников, ежегодные проверки безопасности.</li>
          <li>К данным имеют доступ только сотрудники, допущенные по приказу, и подрядчики по NDA.</li>
          <li>В случае утечки данных Администрация уведомляет Пользователя и Роскомнадзор в течение 72 часов (Постановление Правительства РФ № 1119 от 01.11.2012).</li>
        </ul>
      </motion.section>

      {/* 9. Права и обязанности сторон */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">9. Права и обязанности сторон</h2>
        <ul className="list-disc pl-5 space-y-1" role="list">
          <li>Пользователь вправе получать информацию об обработке своих данных, требовать уточнения, блокирования или удаления персональных данных;</li>
          <li>Пользователь может отозвать согласие на обработку данных, направив запрос на{' '}
            <ContactLink
              href="mailto:info@keytoheart.ru"
              label="Отправить письмо на info@keytoheart.ru"
              type="email"
              onClick={() => handleLinkClick('Запрос на отзыв согласия', 'email')}
            />. Отзыв согласия не влияет на законность обработки, выполненной до отзыва;</li>
          <li>Администрация обязана использовать данные строго в рамках Политики, обеспечивать их конфиденциальность и не передавать третьим лицам без законных оснований;</li>
          <li>Администрация не несёт ответственности за действия третьих лиц, получивших доступ к данным по вине пользователя (например, если он сам предоставил доступ к телефону или email);</li>
        </ul>
      </motion.section>

      {/* 10. Использование Cookies */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">10. Использование Cookies</h2>
        <p>
          Сайт использует cookies для функционирования, аналитики, персонализации и маркетинговых целей. Пользователь может управлять cookies через баннер или настройки браузера. Отключение cookies не влияет на возможность оформления заказа, но может ограничить персонализацию. Подробнее в нашей{' '}
          <PolicyLink page="cookie-policy" onClick={() => handleLinkClick('Политика Cookies', 'policy')} />.
        </p>
      </motion.section>

      {/* 11. Ответственность и разрешение споров */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">11. Ответственность и разрешение споров</h2>
        <p>
          Администрация несёт ответственность за нарушение условий Политики в соответствии с законодательством РФ.
        </p>
        <p>
          Все споры разрешаются путём переговоров, а при недостижении согласия – в суде в соответствии с законодательством РФ, включая право Пользователя подать иск по месту своего жительства (ст. 17 Закона РФ «О защите прав потребителей» № 2300-1).
        </p>
      </motion.section>

      {/* 12. Дополнительные условия */}
      <motion.section variants={sectionVariants} initial="hidden" whileInView="visible" viewport={{ once: true }}>
        <h2 className="text-xl font-semibold">12. Дополнительные условия</h2>
        <ol className="list-decimal pl-5 space-y-1" role="list">
          <li>
            Администрация вправе вносить изменения в Политику, размещая актуальную версию на этой странице. Пользователь обязан самостоятельно следить за изменениями.
          </li>
          <li>
            По вопросам обработки персональных данных обращаться:
            <br />
            ИП Рашевская Регина Сергеевна (ИНН 234810526700, ОГРНИП 324237500032680)
            <br />
            <ContactLink
              href="tel:+79886033821"
              label="Позвонить по номеру +7 (988) 603-38-21"
              type="phone"
              onClick={() => handleLinkClick('Контактный телефон', 'phone')}
            />
            <br />
            Email:{' '}
            <ContactLink
              href="mailto:info@keytoheart.ru"
              label="Отправить письмо на info@keytoheart.ru"
              type="email"
              onClick={() => handleLinkClick('Контактный email', 'email')}
            />
          </li>
        </ol>
      </motion.section>

      <motion.p
        className="text-sm text-gray-500"
        variants={sectionVariants}
        initial="hidden"
        whileInView="visible"
        viewport={{ once: true }}
      >
        Обновлено: 16 июня 2025 г.
      </motion.p>
    </section>
  );
}
